<main>
    <article id="player" [style]="{ 'background-image': 'url(' + currentSong.thumbnailPath + ')'}">
        <audio #audioPlayer (timeupdate)="onTimeUpdate(audioPlayer)" controls (ended)="playNextSong(audioPlayer)">            
            <source [src]="currentSong.soundLink" type="audio/mp3">    
        </audio>

        <div class="player-controls">     
            <div class="player_group">
                <div class="player_song_image" ></div>
                <div>
                    <strong><fa-icon [icon]="songIcon"></fa-icon>&nbsp; {{currentSong.title}}<p style="font-size: small;">{{currentSong.authors.join(', ')}}</p></strong> 
                </div>
            </div>            
            
            <div class="player_group">
                <button class="play-pause" (click)="togglePlayPause(audioPlayer)">
                    @if(!isPlaying) {
                        <fa-icon [icon]="playIcon"></fa-icon>

                    } @else {
                        <fa-icon [icon]="stopIcon"></fa-icon>
                    }
                </button>   

                <input type="range" class="seek-bar" [value]="audioPlayer.currentTime" (input)="seekAudio(audioPlayer, $event)" [max]="audioPlayer.duration" />               
            </div>                        
            
            <div class="volume-control player_group">            
                <label for="volume">
                    @if(volume < 1) {
                        <fa-icon [icon]="volumeLowIcon"></fa-icon>

                    } @else {
                        <fa-icon [icon]="volumeHighIcon"></fa-icon>
                    }
                </label>

                <input class="volume-bar" type="range" id="volume" min="0" max="1" step="0.01" [(ngModel)]="volume" (input)="adjustVolume(audioPlayer)"/>               
            </div>
                        
            @if(audioPlayer.duration && currentTime > 0) {                                                
                <div class="player_group">
                    <fa-icon [icon]="songTimeIcon"></fa-icon>
                    
                    <span class="time">
                        {{ formatTime(audioPlayer.currentTime) }} / {{ formatTime(audioPlayer.duration) }}
                    </span>
                </div>                
            }      
        </div>
    </article>

    <aside id="aside_box">
        <section id="playlist_content">
            <header>
                <h3>Playlists</h3>
                <div class="playlist_controls">
                    <button>
                        <fa-icon [icon]="upIcon"></fa-icon>                     
                    </button>
    
                    <button>
                        <fa-icon [icon]="downIcon"></fa-icon>                    
                    </button>
                </div>            
            </header>

            <div class="playlist_item" *ngFor="let playlist of playlists; index as _pos" [ngClass]="(_pos === selectedPlaylistIndex) ? 'playlist_item_selected' : ''">
                <div (click)="selectPlaylist(_pos, playlist, audioPlayer)">{{playlist.name}}</div>
                <div (click)="selectPlaylist(_pos, playlist, audioPlayer)">{{playlist.numberOfSongs}} songs</div>                                
                <div class="playlist_item_actions">
                    <div>
                        <fa-icon [icon]="editPlaylistIcon"></fa-icon>
                    </div>

                    <div>
                        <fa-icon [icon]="deletePlaylistIcon"></fa-icon>
                    </div>                
                </div>            
            </div>
        </section>

        <section id="playlist_content">
            <header>
                <h3>Playlist songs</h3>
                <div class="playlist_controls">
                    <button>
                        <fa-icon [icon]="upIcon"></fa-icon>                     
                    </button>
    
                    <button>
                        <fa-icon [icon]="downIcon"></fa-icon>                    
                    </button>
                </div>     
            </header>

            <div class="playlist_item" *ngFor="let song of playlistDetails.songs; index as _pos" [ngClass]="(_pos === selectedSongIndex) ? 'playlist_item_selected' : ''">
                <div (click)="selectSong(_pos, song, audioPlayer)">{{_pos + 1}}</div>
                <div class="player_song_image" (click)="selectSong(_pos, song, audioPlayer)" [style]="{ 'background-image': 'url(' + song.thumbnailPath + ')'}"></div>
                <div (click)="selectSong(_pos, song, audioPlayer)" class="song_title_box">{{song.title}}<p style="font-size: smaller;">{{song.authors.join(', ')}}</p></div>
                <div>
                    <button>
                        <fa-icon [icon]="deletePlaylistIcon"></fa-icon>                    
                    </button>
                    
                    <button>
                        <fa-icon [icon]="upIcon"></fa-icon>                     
                    </button>
    
                    <button>
                        <fa-icon [icon]="downIcon"></fa-icon>                    
                    </button>
                </div>
            </div>
        </section>
    </aside>
</main>